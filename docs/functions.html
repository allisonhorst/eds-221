<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Functions | EDS 221: SCIENTIFIC PROGRAMMING ESSENTIALS</title>
  <meta name="description" content="Evolving course materials for EDS 221 (Scientific Programming Essentials)." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Functions | EDS 221: SCIENTIFIC PROGRAMMING ESSENTIALS" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Evolving course materials for EDS 221 (Scientific Programming Essentials)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Functions | EDS 221: SCIENTIFIC PROGRAMMING ESSENTIALS" />
  
  <meta name="twitter:description" content="Evolving course materials for EDS 221 (Scientific Programming Essentials)." />
  

<meta name="author" content="Allison Horst" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="iteration.html"/>
<link rel="next" href="wrangling.html"/>
<script src="libs/header-attrs-2.6.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EDS 221</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Scientific programming essentials for environmental data science</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#material-disclaimer-and-use"><i class="fa fa-check"></i>Material disclaimer and use</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgments"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-introduction"><i class="fa fa-check"></i><b>1.1</b> Course introduction</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#links-to-course-materials"><i class="fa fa-check"></i><b>1.2</b> Links to course materials</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#course-setup"><i class="fa fa-check"></i><b>1.3</b> Course setup</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-resources"><i class="fa fa-check"></i><b>1.4</b> Course resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-py.html"><a href="r-py.html"><i class="fa fa-check"></i><b>2</b> Meet the 221 tools</a>
<ul>
<li class="chapter" data-level="2.1" data-path="r-py.html"><a href="r-py.html#r"><i class="fa fa-check"></i><b>2.1</b> R</a></li>
<li class="chapter" data-level="2.2" data-path="r-py.html"><a href="r-py.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="r-py.html"><a href="r-py.html#python"><i class="fa fa-check"></i><b>2.3</b> Python</a></li>
<li class="chapter" data-level="2.4" data-path="r-py.html"><a href="r-py.html#jupyter-notebooks"><i class="fa fa-check"></i><b>2.4</b> Jupyter Notebooks</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="r-py.html"><a href="r-py.html#py-stuff-to-add-here-or-somewhere"><i class="fa fa-check"></i><b>2.4.1</b> Py stuff to add here or somewhere:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="types.html"><a href="types.html"><i class="fa fa-check"></i><b>3</b> Data types and structures</a>
<ul>
<li class="chapter" data-level="3.1" data-path="types.html"><a href="types.html#data-types"><i class="fa fa-check"></i><b>3.1</b> Data types</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="types.html"><a href="types.html#types-of-data-elements"><i class="fa fa-check"></i><b>3.1.1</b> Types of data elements</a></li>
<li class="chapter" data-level="3.1.2" data-path="types.html"><a href="types.html#atomic-vectors-in-r"><i class="fa fa-check"></i><b>3.1.2</b> Atomic vectors in R</a></li>
<li class="chapter" data-level="3.1.3" data-path="types.html"><a href="types.html#in-python"><i class="fa fa-check"></i><b>3.1.3</b> In Python</a></li>
<li class="chapter" data-level="3.1.4" data-path="types.html"><a href="types.html#side-by-side-comparison-of-data-types-in-r-python"><i class="fa fa-check"></i><b>3.1.4</b> Side-by-side comparison of data types in R &amp; Python</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="types.html"><a href="types.html#data-structures"><i class="fa fa-check"></i><b>3.2</b> Data structures</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="types.html"><a href="types.html#vectors"><i class="fa fa-check"></i><b>3.2.1</b> Vectors</a></li>
<li class="chapter" data-level="3.2.2" data-path="types.html"><a href="types.html#tibbles"><i class="fa fa-check"></i><b>3.2.2</b> Tibbles</a></li>
<li class="chapter" data-level="3.2.3" data-path="types.html"><a href="types.html#matrices"><i class="fa fa-check"></i><b>3.2.3</b> Matrices</a></li>
<li class="chapter" data-level="3.2.4" data-path="types.html"><a href="types.html#lists"><i class="fa fa-check"></i><b>3.2.4</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="types.html"><a href="types.html#allison-random-notes"><i class="fa fa-check"></i><b>3.3</b> Allison random notes</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="types.html"><a href="types.html#converting-between-classes"><i class="fa fa-check"></i><b>3.3.1</b> Converting between classes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidydata.html"><a href="tidydata.html"><i class="fa fa-check"></i><b>4</b> Tidy data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidydata.html"><a href="tidydata.html#common-ways-data-are-untidy"><i class="fa fa-check"></i><b>4.1</b> Common ways data are untidy</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tidydata.html"><a href="tidydata.html#untidy-example-1-a-single-variable-across-multiple-columns"><i class="fa fa-check"></i><b>4.1.1</b> Untidy example 1: A single variable across multiple columns</a></li>
<li class="chapter" data-level="4.1.2" data-path="tidydata.html"><a href="tidydata.html#untidy-example-2-multiple-values-in-a-single-cell"><i class="fa fa-check"></i><b>4.1.2</b> Untidy example 2: multiple values in a single cell</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="tidydata.html"><a href="tidydata.html#tidy-data-makes-coding-easier"><i class="fa fa-check"></i><b>4.2</b> Tidy data makes coding easier</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="tidydata.html"><a href="tidydata.html#code-working-for-you"><i class="fa fa-check"></i><b>4.2.1</b> Code working for you</a></li>
<li class="chapter" data-level="4.2.2" data-path="tidydata.html"><a href="tidydata.html#parse-explore"><i class="fa fa-check"></i><b>4.2.2</b> Parse &amp; explore</a></li>
<li class="chapter" data-level="4.2.3" data-path="tidydata.html"><a href="tidydata.html#safer-summary-statistics"><i class="fa fa-check"></i><b>4.2.3</b> Safer summary statistics</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="tidydata.html"><a href="tidydata.html#tidy-data-for-collaboration"><i class="fa fa-check"></i><b>4.3</b> Tidy data for collaboration</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-wrangling.html"><a href="basic-wrangling.html"><i class="fa fa-check"></i><b>5</b> Basic wrangling</a></li>
<li class="chapter" data-level="6" data-path="logicals.html"><a href="logicals.html"><i class="fa fa-check"></i><b>6</b> Logical operators</a></li>
<li class="chapter" data-level="7" data-path="conditionals.html"><a href="conditionals.html"><i class="fa fa-check"></i><b>7</b> Conditionals</a></li>
<li class="chapter" data-level="8" data-path="iteration.html"><a href="iteration.html"><i class="fa fa-check"></i><b>8</b> Iteration</a>
<ul>
<li class="chapter" data-level="8.1" data-path="iteration.html"><a href="iteration.html#iteration-in-programming"><i class="fa fa-check"></i><b>8.1</b> Iteration in programming</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="iteration.html"><a href="iteration.html#a-real-world-example-of-iteration-in-environmental-data-science"><i class="fa fa-check"></i><b>8.1.1</b> A real-world example of iteration in environmental data science</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="iteration.html"><a href="iteration.html#generic-for-loop-anatomy"><i class="fa fa-check"></i><b>8.2</b> Generic for loop anatomy</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="iteration.html"><a href="iteration.html#anatomy-of-a-for-loop"><i class="fa fa-check"></i><b>8.2.1</b> Anatomy of a for loop</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="iteration.html"><a href="iteration.html#basic-for-loops-in-r-and-python"><i class="fa fa-check"></i><b>8.3</b> Basic for loops in R and Python</a></li>
<li class="chapter" data-level="8.4" data-path="iteration.html"><a href="iteration.html#iteration-with-conditions"><i class="fa fa-check"></i><b>8.4</b> Iteration with conditions</a></li>
<li class="chapter" data-level="8.5" data-path="iteration.html"><a href="iteration.html#while-loop"><i class="fa fa-check"></i><b>8.5</b> While loop</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="iteration.html"><a href="iteration.html#a-while-loop-break-statement"><i class="fa fa-check"></i><b>8.5.1</b> A while loop break statement</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="iteration.html"><a href="iteration.html#r-python-side-by-side-comparisons"><i class="fa fa-check"></i><b>8.6</b> R / Python side-by-side comparisons</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>9</b> Functions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="functions.html"><a href="functions.html#function-components"><i class="fa fa-check"></i><b>9.1</b> Function components</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="functions.html"><a href="functions.html#a-note-on-names"><i class="fa fa-check"></i><b>9.1.1</b> A note on names</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="functions.html"><a href="functions.html#writing-simple-functions"><i class="fa fa-check"></i><b>9.2</b> Writing simple functions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="functions.html"><a href="functions.html#example-1-fish-standard-weight"><i class="fa fa-check"></i><b>9.2.1</b> Example 1: Fish standard weight</a></li>
<li class="chapter" data-level="9.2.2" data-path="functions.html"><a href="functions.html#example-2-wind-turbines"><i class="fa fa-check"></i><b>9.2.2</b> Example 2: Wind turbines</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="functions.html"><a href="functions.html#functions-with-conditionals"><i class="fa fa-check"></i><b>9.3</b> Functions with conditionals</a></li>
<li class="chapter" data-level="9.4" data-path="functions.html"><a href="functions.html#functions-with-iteration"><i class="fa fa-check"></i><b>9.4</b> Functions with iteration</a></li>
<li class="chapter" data-level="9.5" data-path="functions.html"><a href="functions.html#useful-function-features"><i class="fa fa-check"></i><b>9.5</b> Useful function features</a></li>
<li class="chapter" data-level="9.6" data-path="functions.html"><a href="functions.html#testing-functions"><i class="fa fa-check"></i><b>9.6</b> Testing functions</a></li>
<li class="chapter" data-level="9.7" data-path="functions.html"><a href="functions.html#iterating-functions"><i class="fa fa-check"></i><b>9.7</b> Iterating functions</a></li>
<li class="chapter" data-level="9.8" data-path="functions.html"><a href="functions.html#resources-on-building-testing-documenting-functions"><i class="fa fa-check"></i><b>9.8</b> Resources on building, testing, &amp; documenting functions</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="wrangling.html"><a href="wrangling.html"><i class="fa fa-check"></i><b>10</b> Data wrangling with tidyverse and pandas</a></li>
<li class="chapter" data-level="11" data-path="troubleshooting.html"><a href="troubleshooting.html"><i class="fa fa-check"></i><b>11</b> Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="12" data-path="py-r.html"><a href="py-r.html"><i class="fa fa-check"></i><b>12</b> Py-R differences</a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="py-r.html"><a href="py-r.html#overarching-things"><i class="fa fa-check"></i><b>12.0.1</b> Overarching things</a></li>
<li class="chapter" data-level="12.0.2" data-path="py-r.html"><a href="py-r.html#strings-differences"><i class="fa fa-check"></i><b>12.0.2</b> Strings differences:</a></li>
<li class="chapter" data-level="12.0.3" data-path="py-r.html"><a href="py-r.html#number-sequences"><i class="fa fa-check"></i><b>12.0.3</b> Number sequences:</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EDS 221: SCIENTIFIC PROGRAMMING ESSENTIALS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="functions" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Functions</h1>
<p>Writing functions to implement algorithms is a fundamental skill for every environmental data scientist. Functions can reduce repetition, increase efficiency and elegance, and facilitate reuse and sharing. Functions built by other developers will be ingrained into your code, but it’s also critical that you can build, test, document, and share <strong>your own</strong> functions.</p>
<p>This chapter covers:</p>
<ul>
<li>Function structure</li>
<li>Writing basic functions</li>
<li>Nested functions</li>
<li>Functions with iteration and conditions</li>
<li>Useful function features</li>
<li>Testing</li>
<li>Documentation</li>
<li>Applied examples</li>
</ul>
<div id="function-components" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Function components</h2>
<p>At the most basic level, a function takes an input, does something to it (a calculation, transformation, etc.), and returns an output.</p>
<p>For example, we can write a function that doubles the input value. In <em>function notation</em> seen in math, that would be:</p>
<p><span class="math display">\[f(x) = 2x\]</span>
where <span class="math inline">\(x\)</span> is the input, and <span class="math inline">\(f(x)\)</span> is the output. The function <span class="math inline">\(f\)</span> acts on input <span class="math inline">\(x\)</span> by doubling the input value.</p>
<p>How can we create a function to do the same thing in R? An R function would look like this:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="functions.html#cb26-1" aria-hidden="true" tabindex="-1"></a>double_it <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb26-2"><a href="functions.html#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span><span class="sc">*</span>x</span>
<span id="cb26-3"><a href="functions.html#cb26-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>What are these different pieces of that function?</p>
<ul>
<li><strong>function name</strong>: Here, the function is named <code>double_it</code></li>
<li><strong>formals</strong>: The <code>function(x)</code> piece defines the function <em>formals</em> (arguments / parameters). This function expects a single input argument, <code>x</code> (you can check what the formals are using <code>formals(function_name)</code>).</li>
<li><strong>body</strong>: here, <code>{ 2*x }</code> is the body of the function - that’s where we tell it what to do with the inputs. Note the braces (i.e. squiggly brackets) are often on separate lines from the algorithm itself.</li>
</ul>
<p>Try out the function by inputting both a single value, and a vector of values. Note that vectorization is the default - meaning that the function is applied to each element in a vector.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="functions.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">double_it</span>(<span class="at">x =</span> <span class="dv">20</span>)</span></code></pre></div>
<pre><code>## [1] 40</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="functions.html#cb29-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">50</span>) <span class="co"># Create a vector with multiple values</span></span>
<span id="cb29-2"><a href="functions.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="functions.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">double_it</span>(vec) <span class="co"># Function acts on each element in the vector</span></span></code></pre></div>
<pre><code>## [1]   4   8 100</code></pre>
<p>Those are the main pieces. But don’t worry, it gets a lot more interesting. Let’s start by writing a few of our own functions.</p>
<div id="a-note-on-names" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> A note on names</h3>
<p>It’s important to be thoughtful when naming functions. We generally want to follow standard practices for good names (concise, descriptive, code and coder-friendly), but you may also consider the following:
- Start with a verb that describes what the function <em>does</em> (e.g. <code>sort</code>, <code>build</code>, <code>predict</code>)
- End with a noun describing the thing it works with or creates (e.g. <code>image</code>, <code>model</code>, <code>mass</code>)
- Combine them with a coder-friendly case (like <code>lower_snake_case</code>)</p>
<p>For example, here are some suggestions that may be useful function names:</p>
<pre><code>`sum_imports`, `predict_offsets`, `plot_simulations`</code></pre>
<p>In contrast, here are some function names that may be less useful, memorable, and intuitive for you and collaborators:</p>
<pre><code>`fun_1`, `calc`, `x2`</code></pre>
<p>It is likely that there will be a tradeoff between conciseness and descriptiveness. While there aren’t <em>rules</em> about naming functions, I recommend erring on the side of descriptiveness to make reading and writing code a bit more intuitive. With tab-completion, the decrease in efficiency is minimal.</p>
</div>
</div>
<div id="writing-simple-functions" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Writing simple functions</h2>
<p>Let’s practice writing a few simple functions using established relationships in environmental science.</p>
<div id="example-1-fish-standard-weight" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Example 1: Fish standard weight</h3>
<p>“Standard weight” is how much we <em>expect</em> a fish to weigh, give the species and fish length, and the nonlinear relationship is given by:</p>
<p><span class="math display">\[W=aL^b\]</span></p>
<p>where <span class="math inline">\(L\)</span> is total fish length (centimeters), <span class="math inline">\(W\)</span> is the expected fish weight (grams), and <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are species-dependent parameter values.</p>
<p>Write a function to calculate fish weight based on <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and fish length, then estimate the weight of several fish based on the following parameter estimates for Hawaiian fish from <span class="citation"><a href="py-r.html#ref-peyton_lengthweight_2016" role="doc-biblioref">Peyton et al.</a> (<a href="py-r.html#ref-peyton_lengthweight_2016" role="doc-biblioref">2016</a>)</span>:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-24">Table 9.1: </span>Parameter estimates for selected Hawaiian fish from Peyton et al. (2015).
</caption>
<thead>
<tr>
<th style="text-align:left;">
Scientific name
</th>
<th style="text-align:left;">
Common name
</th>
<th style="text-align:center;">
a
</th>
<th style="text-align:center;">
b
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;font-style: italic;">
Chanos chanos
</td>
<td style="text-align:left;">
Milkfish
</td>
<td style="text-align:center;">
0.0905
</td>
<td style="text-align:center;">
2.52
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Sphyraena barracuda
</td>
<td style="text-align:left;">
Great barracuda
</td>
<td style="text-align:center;">
0.0181
</td>
<td style="text-align:center;">
3.27
</td>
</tr>
<tr>
<td style="text-align:left;font-style: italic;">
Caranx ignobilis
</td>
<td style="text-align:left;">
Giant trevally
</td>
<td style="text-align:center;">
0.0353
</td>
<td style="text-align:center;">
3.05
</td>
</tr>
</tbody>
</table>
<p>Function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="functions.html#cb33-1" aria-hidden="true" tabindex="-1"></a>predict_weight <span class="ot">&lt;-</span> <span class="cf">function</span>(a, length, b) {</span>
<span id="cb33-2"><a href="functions.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  a<span class="sc">*</span>(length<span class="sc">^</span>b)</span>
<span id="cb33-3"><a href="functions.html#cb33-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Using the function:</p>
<ol style="list-style-type: decimal">
<li>Estimate the mass of a 160 cm long great barracuda.</li>
<li>Estimate the mass of a 118 cm long milkfish.</li>
</ol>
<p><strong>Thinking ahead:</strong> Does this pass your smell test for a user-friendly and user-helpful function? How might we make this function simpler for a user? For example, maybe a user can input the <em>species</em>, and the parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> can be correctly sourced from a table? We’ll learn how to add this kind of functionality in upcoming sections.</p>
</div>
<div id="example-2-wind-turbines" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Example 2: Wind turbines</h3>
<p>The full power in wind hitting a turbine is:</p>
<p><span class="math display">\[P = 0.5\rho Av^3\]</span></p>
<p>where <span class="math inline">\(P\)</span> is power in Watts (joules/second), <span class="math inline">\(\rho\)</span> is the air density (kg/m<sup>3</sup>), <span class="math inline">\(A\)</span> is the area covered by the turbine blades (square meters), and <span class="math inline">\(v\)</span> is the wind velocity (m/s).</p>
<p>However, the <a href="https://energyeducation.ca/encyclopedia/Betz_limit">Betz Limit</a> means that turbines can only collect ~60% of the total wind power, which updates the theoretical “collectable” power (before accounting for inefficiencies, losses, etc.) to:</p>
<p><span class="math display">\[P = 0.3\rho Av^3\]</span>
Write a function to calculate <em>maximum collectable</em> wind power (Watts) by a turbine requiring three inputs:</p>
<ul>
<li>Air density (in kg/m<sup>3</sup>)</li>
<li>Rotor radius (in meters)</li>
<li>Wind velocity (in m/s)</li>
</ul>
<p>Write the function:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="functions.html#cb34-1" aria-hidden="true" tabindex="-1"></a>calc_windpower <span class="ot">&lt;-</span> <span class="cf">function</span>(rho, radius, windspeed) {</span>
<span id="cb34-2"><a href="functions.html#cb34-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-3"><a href="functions.html#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.3</span><span class="sc">*</span>rho<span class="sc">*</span>pi<span class="sc">*</span>(radius<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(windspeed<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb34-4"><a href="functions.html#cb34-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-5"><a href="functions.html#cb34-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Can we clean this up a bit by calculating the area first, within the function? Sure!</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="functions.html#cb35-1" aria-hidden="true" tabindex="-1"></a>calc_windpower <span class="ot">&lt;-</span> <span class="cf">function</span>(rho, radius, windspeed) {</span>
<span id="cb35-2"><a href="functions.html#cb35-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb35-3"><a href="functions.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate turbine area (meters squared):</span></span>
<span id="cb35-4"><a href="functions.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  turbine_area <span class="ot">=</span> pi<span class="sc">*</span>(radius<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb35-5"><a href="functions.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb35-6"><a href="functions.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate collectable power:</span></span>
<span id="cb35-7"><a href="functions.html#cb35-7" aria-hidden="true" tabindex="-1"></a>  <span class="fl">0.3</span><span class="sc">*</span>rho<span class="sc">*</span>turbine_area<span class="sc">*</span>(windspeed<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb35-8"><a href="functions.html#cb35-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now let’s use the function we’ve created.</p>
<p>The largest turbine in the world (as of March 2021) is the <a href="https://www.ge.com/renewableenergy/wind-energy/offshore-wind/haliade-x-offshore-turbine">GE Haliade-X</a>, an offshore turbine prototype in Rotterdam, the Netherlands, with a 220 meter rotor diameter.</p>
<p>Assuming a windspeed of 7.7 m/s (based on long-term averages for North sea North Sea platforms from <span class="citation"><a href="py-r.html#ref-coelingh_analysis_1998" role="doc-biblioref">Coelingh, Wijk, and Holtslag</a> (<a href="py-r.html#ref-coelingh_analysis_1998" role="doc-biblioref">1998</a>)</span>) and an air density of 1.225 kg/m<sup>3</sup> (at sea level), estimate the wind power that can be collected.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="functions.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">calc_windpower</span>(<span class="at">rho =</span> <span class="fl">1.225</span>, <span class="at">radius =</span> <span class="dv">110</span>, <span class="at">windspeed =</span> <span class="fl">7.7</span>) <span class="co"># Watts</span></span></code></pre></div>
<pre><code>## [1] 6377710</code></pre>
</div>
</div>
<div id="functions-with-conditionals" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Functions with conditionals</h2>
<p>In the examples above, we change input values, but what the function <em>does</em> doesn’t change based on those input values.</p>
<p>Sometimes, we’ll want our function to do something different (e.g. a different calculation, use a different constant value) based on the input values.</p>
</div>
<div id="functions-with-iteration" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Functions with iteration</h2>
</div>
<div id="useful-function-features" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Useful function features</h2>
</div>
<div id="testing-functions" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Testing functions</h2>
</div>
<div id="iterating-functions" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Iterating functions</h2>
</div>
<div id="resources-on-building-testing-documenting-functions" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Resources on building, testing, &amp; documenting functions</h2>
<ul>
<li><a href="https://adv-r.hadley.nz/functions.html">Ch. 6 - Functions</a> in <a href="https://adv-r.hadley.nz/"><em>Advanced R</em></a> by Hadley Wickham</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="iteration.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wrangling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["eds-221.pdf", "eds-221.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
